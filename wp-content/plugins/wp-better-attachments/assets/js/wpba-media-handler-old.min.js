var wpba={};wpba.updateSortOrder=function(t){var $=jQuery,e=t.find("li"),a=[],n={action:"wpba_update_sort_order"},i=$(".wpba-saving");e.each(function(){var t=$(this);a.push(t.data("id"))}),n.attids=a,i.removeClass("hide"),$.post(ajaxurl,n,function(t){return i.addClass("hide"),!1})},wpba.updateSortOrderClickHandler=function(){var $=jQuery,t=$("#wpba_image_sortable");t.sortable(),t.on("sortupdate",function(e,a){wpba.updateSortOrder(t)})},wpba.unattachAttachment=function(t){var $=jQuery,e=$("#wpba_image_sortable"),a=t.parent("li").parent("ul").parent("div"),n=a.data("id"),i={action:"wpba_unattach_attachment",attachmentid:n},s=$(".wpba-saving");s.removeClass("hide"),$.post(ajaxurl,i,function(t){var a=$.parseJSON(t);a&&($("#attachment_"+n).remove(),wpba.updateSortOrder(e),0===e.children("li").length&&$("#wpba_attachments_button2").addClass("hide"))})},wpba.unattachAttachmentClickHandler=function(){$=jQuery,$(".wpba-unattach").on("click",function(t){return wpba.unattachAttachment($(this)),t.preventDefault(),!1})},wpba.unattachLibraryAttachmentClickHandler=function(){$=jQuery,$(".wpba-unattach-library").on("click",function(t){var e=$(this),a=e.data("id"),n={action:"wpba_unattach_attachment",attachmentid:a};return $.post(ajaxurl,n,function(t){var n=$.parseJSON(t);n&&($("#post-"+a+" .reattach").remove(),$("#post-"+a+" .unattach").remove(),$(".wpba-list-spacer").removeClass("wpba-list-spacer"),e.parents(".unattach-wrap").remove(),$("#post-"+a+" .view").empty().append('<a href="http://localhost/~mothership/plugin-dev/?attachment_id='+a+'" title="View “Hello world!”" rel="permalink">View</a>'),$("#post-"+a+" .column-parent").empty().append("(Unattached)<br><a class=\"hide-if-no-js\" onclick=\"findPosts.open( 'media[]','"+a+'\' ); return false;" href="#the-list">Attach</a>'))}),t.preventDefault(),!1})},wpba.deleteAttachment=function(t){var $=jQuery,e=confirm("Are you sure you want to permanently delete this attachment? This will permanently remove the attachment from the media gallery!!"),a=$(".wpba-saving"),n=$("#wpba_image_sortable");if(e){var i=t.parent("li").parent("ul").parent("div"),s=i.data("id"),p={action:"wpba_delete_attachment",attachmentid:s};a.removeClass("hide"),$.post(ajaxurl,p,function(t){var e=$.parseJSON(t);e&&($("#attachment_"+s).remove(),wpba.updateSortOrder(n),0===n.children("li").length&&$("#wpba_attachments_button2").addClass("hide")),a.addClass("hide")})}},wpba.deleteAttachmentClickHandler=function(){$=jQuery,$(".wpba-delete").on("click",function(t){return wpba.deleteAttachment($(this)),t.preventDefault(),!1})},wpba.refreshAttachments=function(t){var $=jQuery,e={action:"wpba_refresh_attachments",postid:$(".wpba").data("postid")},a=$("#wpba_image_sortable");return $.getJSON(ajaxurl,e,function(t){a.empty().append(t),wpba.resetClickHandlers()}),!1},wpba.editModalClickHandler=function(){$=jQuery,$("#wpba_edit_screen").length>0&&($(".wpba-edit").on("click",function(t){var e=$(this);return attid=wpba.showEditScreenModal(e),t.preventDefault(),!1}),$("#wpba_edit_screen_close").on("click",function(t){var e=$(this);return wpba.refreshAttachments(attid),$("#wpba_edit_screen").hide(),t.preventDefault(),!1}))},wpba.showEditScreenModal=function(t){var e=$("#wpba_edit_screen"),a=e.find("iframe"),n=e.data("settings"),i;a.attr("src",t.attr("href")),a.load(function(){return css="#adminmenuwrap,#adminmenuback,#wpadminbar,#screen-meta-links,#wpfooter,.add-new-h2 { display: none; }#wpcontent { width: 96%; margin: 0 2%; }",n.caption&&(css+=' #attachment_caption, label[for="attachment_caption"] { display: none; }'),n.alt&&(css+=' #wp-attachment_content-wrap, label[for="content"] { display: none; }'),n.description&&(css+='#attachment_alt, label[for="attachment_alt"] { display: none; }'),a.contents().find("head").append($("<style type='text/css'>"+css+"</style>")),i=a.contents().find("#post_ID").val(),a.contents().find("#publish").on("click",function(){a.hide(),a.load(function(){a.contents().find("head").append($("<style type='text/css'>"+css+"</style>")),a.show()})}),e.show(),i})},wpba.updatePost=function(t,e,a){var $=jQuery,n=void 0!=n?n:!1;ajaxData={action:"wpba_update_post",id:t,key:e,value:a},$.post(ajaxurl,ajaxData,function(t){})},wpba.titleBlurHandler=function(){var $=jQuery;$(".wpba-attachment-title").on("blur",function(){var t=$(this),e=t.parent("div").parent("div").data("id");wpba.updatePost(e,"post_title",t.val())})},wpba.captionBlurHandler=function(){var $=jQuery;$(".wpba-attachment-caption").on("blur",function(){var t=$(this),e=t.parent("div").parent("div").data("id");wpba.updatePost(e,"post_excerpt",t.val())})},wpba.resetClickHandlers=function(){wpba.updateSortOrderClickHandler(),wpba.unattachAttachmentClickHandler(),wpba.unattachLibraryAttachmentClickHandler(),wpba.deleteAttachmentClickHandler(),wpba.editModalClickHandler(),wpba.titleBlurHandler(),wpba.captionBlurHandler()},wpba.settingsDisablePostTypes=function(t){var e=$("#wpba-"+t.val()+"-disable-attachment-types-wrap"),a=e.parents("tr"),n=$("#wpba-"+t.val()+"-settings-wrap"),i=n.parents("tr"),s=$(".wpba-"+t.val()+"-meta-box-title"),p=s.parents("tr"),r=$(".wpba-"+t.val()+"-enabled-pages"),o=r.parents("tr"),c=$("#wpba-global-settings-wrap").parents("tr"),d=$("#wpba-meta-box-settings-wrap").parents("tr"),l=$("#wpba-edit-modal-settings-wrap").parents("tr"),b=$("#wpba-disable-attachment-types-wrap").parents("tr"),w=$('#wpba-disable-post-types-wrap input[type="checkbox"]'),h=!0;w.each(function(){return $(this).is(":checked")?void 0:void(h=!1)}),h?(c.hide(),d.hide(),l.hide(),b.hide()):(c.show(),d.show(),l.show(),b.show()),h=!0,t.is(":checked")?(i.hide(),a.hide(),p.hide(),o.hide()):(i.show(),a.show(),p.show(),o.show()),$(".wpba-loading").removeClass("wpba-loading"),$("#wpba_settings").animate({opacity:1},150),$(".wpba-settings-sidebar").animate({opacity:1},150)},wpba.globalSettingsHandler=function(t,e){elem=$(e),t.is(":checked")?(elem.hide(),elem.next("br").hide()):(elem.show(),elem.next("br").show()),$("#wpba_settings").animate({opacity:1},150),$(".wpba-settings-sidebar").animate({opacity:1},150)},wpba.settingsCheckBoxSetupHandler=function(t,e){t.on("change",function(){wpba.globalSettingsHandler($(this),e)}).each(function(){wpba.globalSettingsHandler($(this),e)})},jQuery(function($){$(window).load(function(){wpba.resetClickHandlers();var t=$('#wpba-disable-post-types-wrap input[type="checkbox"]'),e=$(".wpba-settings-hide"),a=$('input[type="checkbox"].wpba-settings-thumbnail'),n=$('input[type="checkbox"].wpba-settings-no_crop_editor'),i=$('input[type="checkbox"].wpba-settings-gmb_title'),s=$('input[type="checkbox"].wpba-settings-gmb_caption'),p=$('input[type="checkbox"].wpba-settings-gmb_show_attachment_id'),r=$('input[type="checkbox"].wpba-settings-gmb_unattach_link'),o=$('input[type="checkbox"].wpba-settings-gmb_edit_link'),c=$('input[type="checkbox"].wpba-settings-gmb_delete_link'),d=$('input[type="checkbox"].wpba-settings-gem_caption'),l=$('input[type="checkbox"].wpba-settings-gem_alternative_text'),b=$('input[type="checkbox"].wpba-settings-gem_description'),w=$('input[type="checkbox"].wpba-settings-disable_image'),h=$('input[type="checkbox"].wpba-settings-disable_video'),u=$('input[type="checkbox"].wpba-settings-disable_audio'),m=$('input[type="checkbox"].wpba-settings-disable_document');e.on("click",function(t){var e=$(this),a=e.parents("th").siblings("td");return"hide"==e.text()?(a.hide(),e.text("show")):(a.show(),e.text("hide")),t.preventDefault(),!1}),wpba.settingsCheckBoxSetupHandler(w,".wpba-settings-pt_disable_image"),wpba.settingsCheckBoxSetupHandler(h,".wpba-settings-pt_disable_video"),wpba.settingsCheckBoxSetupHandler(u,".wpba-settings-pt_disable_audio"),wpba.settingsCheckBoxSetupHandler(m,".wpba-settings-pt_disable_document"),wpba.settingsCheckBoxSetupHandler(d,".wpba-settings-em_caption"),wpba.settingsCheckBoxSetupHandler(l,".wpba-settings-em_alternative_text"),wpba.settingsCheckBoxSetupHandler(b,".wpba-settings-em_description"),wpba.settingsCheckBoxSetupHandler(i,".wpba-settings-title"),wpba.settingsCheckBoxSetupHandler(s,".wpba-settings-caption"),wpba.settingsCheckBoxSetupHandler(p,".wpba-settings-mb_show_attachment_id"),wpba.settingsCheckBoxSetupHandler(r,".wpba-settings-mb_unattach_link"),wpba.settingsCheckBoxSetupHandler(o,".wpba-settings-mb_edit_link"),wpba.settingsCheckBoxSetupHandler(c,".wpba-settings-mb_delete_link"),wpba.settingsCheckBoxSetupHandler(n,".wpba-settings-all_crop_sizes"),wpba.settingsCheckBoxSetupHandler(a,".wpba-settings-mb_thumbnail"),t.on("change",function(){wpba.settingsDisablePostTypes($(this))}).each(function(){wpba.settingsDisablePostTypes($(this))})})}(jQuery)),jQuery(function($){$(window).load(function(){$("#wpba_attachments_button").on("click",function(){return tb_show("","media-upload.php?type=image&amp;TB_iframe=true"),window.original_send_to_editor=window.send_to_editor,window.send_to_editor=function(t){imgurl=jQuery(t).attr("src"),imgurl||(imgurl=jQuery("img",t).attr("src")),imgurl||(imgurl=jQuery(t).attr("href"));var e=$("#wpba_image_sortable"),a=$(".wpba-saving"),n={attachmenturl:imgurl,action:"wpba_add_attachment_old",parentid:$(".wpba").data("postid")};a.removeClass("hide"),$.post(ajaxurl,n,function(t){resp=$.parseJSON(t),resp&&(e.append(resp.image),wpba.updateSortOrder(e),wpba.resetClickHandlers())}),tb_remove(),window.send_to_editor=window.original_send_to_editor},!1})})}(jQuery));
//# sourceMappingURL=./wpba-media-handler-old.min.js.map